<!DOCTYPE html>
<html lang="ja" xmlns:th="http://www.thymeleaf.org"
	xmlns="http://www.w3.org/1999/xhtml">


<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>社員マスタ登録</title>


<script type="text/javascript"
	th:src="@{/js/common/jquery-3.3.1.min.js}"></script>
<script type="text/javascript" th:src="@{/js/common/jquery-ui.js}"></script>
<script type="text/javascript"
	th:src="@{/js/common/bootstrap.bundle.js}"></script>
<script type="text/javascript"
	th:src="@{/js/common/bootstrap-datepicker.js}"></script>
<script type="text/javascript"
	th:src="@{/js/common/bootstrap-datepicker.ja.min.js}"></script>
<script type="text/javascript"
	th:src="@{/js/common/bootstrap-select.js}"></script>
<script type="text/javascript" th:src="@{/js/common/common.js}"></script>
<link rel="stylesheet" type="text/css"
	th:href="@{/css/common/bootstrap.css}" />
<link rel="stylesheet" type="text/css"
	th:href="@{/css/common/bootstrap3icons.css}" />
<link rel="stylesheet" type="text/css"
	th:href="@{/css/common/bootstrap-theme.min.css}" />
<link rel="stylesheet" type="text/css"
	th:href="@{/css/common/bootstrap-datepicker.min.css}" />
<link rel="stylesheet" type="text/css"
	th:href="@{/css/common/bootstrap-select.min.css}" />
<link rel="stylesheet" type="text/css"
	th:href="@{/css/common/style.css}" />
<link rel="stylesheet" th:href="@{/fontawesome/all.min.css}" />

<style>
/*保有資格の入力フォーム*/
sen-mx {
	width: 270px !important;
}

.sen-numeric-emp {
	text-align: center;
	width: 180px !important;;
	ime-mode: disabled;
}

.sen-required-position::before {
	font-weight: bold;
	color: #CC0000;
	content: "＊";
	margin-left: 30px
}
/*「登録」ボタンのレイアウト及び位置指定*/
.btn-position {
	position: relative;
	left: 0.5%;
	background-color: darkorange;
	border-style: solid;
	box-shadow: 1px 1px 2px;
}

/*「更新」ボタンのレイアウト及び位置指定*/
.btn-position-detail {
	position: relative;
	left: 0.5%;
	background-color: darkorange;
	border-style: solid;
	box-shadow: 1px 1px 2px;
}
</style>
<script>
	$(function() {
		$("#hireDateYm").datepicker({
			language : 'ja',
			startView : 1,
			format : 'yyyy/mm',
			autoclose : true,
			immediateUpdates : true,
			minViewMode : 1,
			orientation : 'bottom',
		});
	});
</script>
<script>
	$(function() {
		$(document)
				.on(
						"click",
						".btn",
						function() {
							var submit = $(this);
							if ($(this).val() == '登録') {
								$(function() {
									var flag = regCheck(flag);
									if (flag) {
										$("#mes").html(MESSAGE.ERR002).css(
												'color', 'red').css(
												'border-bottom',
												'solid 1px red');
										var scr = scrollTop(scr);
									} else {
										var $form = $("form");
										$
												.ajax(
														{
															type : 'GET',
															dataType : 'json',
															url : getContextUrl('/master/employee/regist/check'),
															data : $form
																	.serialize(),
														})
												.done(
														function(data) {
															var error = data["msg"];
															if (error == null) {
																var regist = confirm(MESSAGE.INF001);
																if (regist == true) {
																	$(function() {
																		var $form = $("form");
																		$
																				.ajax(
																						{
																							type : 'GET',
																							dataType : 'html',
																							url : getContextUrl('/master/employee/register'),
																							data : $form
																									.serialize(),
																						})
																				.done(
																						function(
																								data) {
																							$(
																									"#mes")
																									.html(
																											MESSAGE.INF004)
																									.css(
																											'color',
																											'#3CB371')
																									.css(
																											'border-bottom',
																											'solid 1px #66CC33');
																							$(
																									'form')
																									.html(
																											$(
																													'form')
																													.html());
																							var scr = scrollTop(scr);
																							var date = datepicker(date);
																						})
																	})
																}
															} else {
																$("#mes")
																		.html(
																				MESSAGE.ERR003)
																		.css(
																				'color',
																				'red')
																		.css(
																				'border-bottom',
																				'solid 1px red');
																var scr = scrollTop(scr);
															}
														})
									}
								})
							}
							if ($(this).val() == '更新') {
								$(function() {
									var flag = regCheck(flag);
									if (flag) {
										$("#mes").html(MESSAGE.ERR002).css(
												'color', 'red').css(
												'border-bottom',
												'solid 1px red');
										var scr = scrollTop(scr);
									} else {
										var regist = confirm(MESSAGE.INF002);
										if (regist == true) {
											$(function() {
												var $form = $("form");
												$
														.ajax(
																{
																	type : 'GET',
																	dataType : 'html',
																	url : getContextUrl('/master/employee/update'),
																	data : $form
																			.serialize(),
																})
														.done(
																function(data) {
																	$("#mes")
																			.html(
																					MESSAGE.INF005)
																			.css(
																					'color',
																					'#3CB371')
																			.css(
																					'border-bottom',
																					'solid 1px #66CC33');
																	var scr = scrollTop(scr);
																})
											})
										}
									}
								})
							}
						})
		//必須項目チェック処理共通化
		function regCheck(flag) {
			var regex = new RegExp(/^[a-zA-Z]+$/);//空文字判定
			var str = "";
			var flag = 0;
			if (document.check.EmployeeCd.value == regex.test(str)) {
				flag = 1;
			} else if (document.check.EmployeeName.value == regex.test(str)) {
				flag = 1;
			} else if (document.check.hireDateYm.value == regex.test(str)) {
				flag = 1;
			}
			return flag;
		}
	});
</script>
</head>

<body>
	<!--ヘッダ-->
	<header class="sen-header">
		<div id="header-area" th:replace="common/header"></div>
	</header>

	<!--メニュー-->
	<aside class="sen-menu" role="complementary" id="side">
		<div id="menu-area" th:replace="common/menu"></div>
	</aside>

	<main class="sen-contents clearfix" role="main" id="main">
	<div class="sen-main-contents">

		<p class="title">
			<b>社員マスタ登録</b>
		</p>

		<span id="mes" class="message"></span>

		<form th:id="form" th:object="${form}" method="GET" name="check">
			<br></br>
			<p th:if="*{EmployeeCd == null}">
				&emsp;&emsp;登録項目を入力してください。<b class="sen-required-position">は必須項目</b>
			</p>
			<p th:if="*{EmployeeCd != null}">
				&emsp;&emsp;更新項目を入力してください。<b class="sen-required-position">は必須項目</b>
			</p>

			<div class="sen-line"></div>
			<div class="sen-required-position">
				<div class="sen-group-left-exist">
					<label class="sen-title-position">社員番号</label> <input type="text"
						th:if="*{EmployeeCd == null}" th:field="*{EmployeeCd}"
						class="form-control sen-numeric-emp sen-sm" maxlength="6"
						autocomplete="off" /> <input type="text"
						th:if="*{EmployeeCd != null}" th:field="*{EmployeeCd}"
						readonly="readonly" class="form-control sen-cd sen-sm code-pk"
						maxlength="6" />
				</div>
			</div>

			<div class="sen-line"></div>
			<div class="sen-required-position">
				<div class="sen-group-left-exist">
					<label class="sen-title-position">氏名</label> <input type="text"
						id="" name="" th:field="*{EmployeeName}"
						class="form-control sen-text sen-sm" maxlength="15"
						autocomplete="off" />
				</div>
			</div>

			<div class="sen-line"></div>
			<div class="sen-group-left-nonexist">
				<label class="sen-title-position sen-cd">カナ氏名</label> <input
					type="text" id="sample" name="employeeNameKana"
					th:field="*{EmployeeNameKana}" class="form-control sen-text sen-sm"
					maxlength="30" autocomplete="off" />
			</div>

			<div class="sen-line"></div>
			<div class="sen-required-position">
				<div class="sen-group-left-exist">
					<label class="sen-title-position sen-cd">入社年月</label> <input
						type="text" id="" name="" th:field="*{hireDateYm}"
						class="form-control sen-cd sen-sm" autocomplete="off" />
				</div>
			</div>

			<div class="sen-line"></div>
			<div class="sen-group-left-nonexist">
				<label class="sen-title-position">趣味</label> <input type="text"
					id="sample" name="hobby" th:field="*{hobby}"
					class="form-control sen-numeric1 sen-sm" maxlength="10"
					autocomplete="off" />
			</div>

			<div class="sen-line"></div>
			<div class="sen-group-left-nonexist">
				<label class="sen-title-position sen-cd">保有資格1</label> <select
					id="qualification1" name="qualification1"
					class="form-control sen-mx">
					<option th:each="item : *{qualificationMap}" th:value="${item.key}"
						th:text="${item.value}"
						th:selected="${item.key} == *{qualification1}">singleSelect</option>
				</select>
			</div>

			<div class="sen-line"></div>
			<div class="sen-group-left-nonexist">
				<label class="sen-title-position sen-cd ">保有資格2</label> <select
					id="qualification2" name="qualification2"
					class="form-control sen-mx">
					<option th:each="item : *{qualificationMap}" th:value="${item.key}"
						th:text="${item.value}"
						th:selected="${item.key} == *{qualification2}">singleSelect</option>
				</select>
			</div>

			<div class="sen-line"></div>
			<div class="sen-group-left-nonexist">
				<label class="sen-title-position">保有資格3</label> <select
					id="qualification3" name="qualification3"
					class="form-control sen-mx">
					<option th:each="item : *{qualificationMap}" th:value="${item.key}"
						th:text="${item.value}"
						th:selected="${item.key} == *{qualification3}">singleSelect</option>
				</select>
			</div>
			<br></br> <br></br> <br></br> <br></br> <br></br>

			<div class="sen-btn-right">
				<a href="/U-SWEB/master/employee/search"> <input id="btn-back"
					type="button" class="btn-lg btn-position-back btn"
					th:if="*{EmployeeCd != null}" value="戻る" /></a> <input id="btn-regist"
					type="button" class="btn-lg btn-position-detail btn"
					th:if="*{EmployeeCd != null}" value="更新" /> <input id="btn-regist"
					type="button" class="btn-lg btn-position btn"
					th:if="*{EmployeeCd == null}" value="登録" />
			</div>
			<br></br> <br></br>
		</form>

	</div>
	</main>

	<!--フッター-->
	<footer class="sen-footer">
		<div id="footer-area" th:replace="common/footer"></div>
	</footer>

</body>

</html>